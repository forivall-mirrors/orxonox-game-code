ENABLE_TESTING()

ADD_CUSTOM_TARGET(test COMMAND ${CMAKE_CTEST_COMMAND})

ADD_EXECUTABLE(sample_test EXCLUDE_FROM_ALL SampleTest.cc)
ADD_DEPENDENCIES(test sample_test)

ADD_TEST(test1a ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/sample_test)
ADD_TEST(test1b ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/sample_test)
ADD_TEST(test1c ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/sample_test)


IF(Boost_UNIT_TEST_FRAMEWORK_FOUND)
  INCLUDE_DIRECTORIES(
    ${Boost_INCLUDE_DIRS}
  )
  ADD_EXECUTABLE(boost_test EXCLUDE_FROM_ALL BoostTest.cc)
  TARGET_LINK_LIBRARIES(boost_test ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY})
  ADD_DEPENDENCIES(test boost_test)

  ADD_TEST(test2 ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/boost_test)
ENDIF()
